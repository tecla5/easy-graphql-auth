(function(b,c){'object'==typeof exports&&'object'==typeof module?module.exports=c():'function'==typeof define&&define.amd?define([],c):'object'==typeof exports?exports.apolloConn=c():b.apolloConn=c()})(this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.i=function(d){return d},b.d=function(d,e,f){b.o(d,e)||Object.defineProperty(d,e,{configurable:!1,enumerable:!0,get:f})},b.n=function(d){var e=d&&d.__esModule?function(){return d['default']}:function(){return d};return b.d(e,'a',e),e},b.o=function(d,e){return Object.prototype.hasOwnProperty.call(d,e)},b.p='',b(b.s=2)}([function(a,b,c){'use strict';function d(l,m){if(!(l instanceof m))throw new TypeError('Cannot call a class as a function')}function e(l,m){if(!l)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return m&&('object'==typeof m||'function'==typeof m)?m:l}function f(l,m){if('function'!=typeof m&&null!==m)throw new TypeError('Super expression must either be null or a function, not '+typeof m);l.prototype=Object.create(m&&m.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(l,m):l.__proto__=m)}Object.defineProperty(b,'__esModule',{value:!0}),b.LokkaConnection=void 0;var h=function(){function l(m,n){for(var p,o=0;o<n.length;o++)p=n[o],p.enumerable=p.enumerable||!1,p.configurable=!0,'value'in p&&(p.writable=!0),Object.defineProperty(m,p.key,p)}return function(m,n,o){return n&&l(m.prototype,n),o&&l(m,o),m}}();b.createConnection=function(l){return new k(l).connect()};var j=c(1),k=b.LokkaConnection=function(l){function m(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};d(this,m);var p=e(this,(m.__proto__||Object.getPrototypeOf(m)).call(this,n));return p.Lokka=n.Lokka||o.Lokka,p.Transport=n.Transport||o.Transport,p.createLokka=n.CreateLokka||o.CreateLokka||p.createLokkaClient,p.createTransport=n.createTransport||o.createTransport||p.createLokkaTransport,o.bind&&(p.createLokka.bind(p),p.createTransport.bind(p)),p}return f(m,l),h(m,[{key:'connect',value:function(){var o,p;return this.headers=o={Authorization:'Bearer '+this.tokens.auth0IdToken},this.transport=p=this.createTransport(o),this.client=this.createLokka(p),this}},{key:'createLokkaClient',value:function(o){return new this.Lokka({transport:o||this.transport})}},{key:'createLokkaTransport',value:function(o){var p=o.headers,q=o.endpoint;return q=q||this.config.graphCool.endpoint,new this.Transport(q,{headers:p||this.headers})}}]),m}(j.GraphQLConnection)},function(a,b,c){'use strict';(function(d){var e,f,g,h='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(j){return typeof j}:function(j){return j&&'function'==typeof Symbol&&j.constructor===Symbol&&j!==Symbol.prototype?'symbol':typeof j};(function(k,l){'object'===h(b)&&'object'===h(d)?d.exports=l():(f=[],e=l,g='function'==typeof e?e.apply(b,f):e,!(g!==void 0&&(d.exports=g)))})(void 0,function(){return function(j){function k(m){if(l[m])return l[m].exports;var n=l[m]={i:m,l:!1,exports:{}};return j[m].call(n.exports,n,n.exports,k),n.l=!0,n.exports}var l={};return k.m=j,k.c=l,k.i=function(m){return m},k.d=function(m,n,o){k.o(m,n)||Object.defineProperty(m,n,{configurable:!1,enumerable:!0,get:o})},k.n=function(m){var n=m&&m.__esModule?function(){return m['default']}:function(){return m};return k.d(n,'a',n),n},k.o=function(m,n){return Object.prototype.hasOwnProperty.call(m,n)},k.p='',k(k.s=3)}([function(j,k,l){'use strict';(function(m){var n,o,p,q='function'==typeof Symbol&&'symbol'===h(Symbol.iterator)?function(r){return'undefined'==typeof r?'undefined':h(r)}:function(r){return r&&'function'==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?'symbol':'undefined'==typeof r?'undefined':h(r)};(function(s,t){'object'===q(k)&&'object'===q(m)?m.exports=t():(o=[],n=t,p='function'==typeof n?n.apply(k,o):n,!(p!==void 0&&(m.exports=p)))})(void 0,function(){return function(r){function s(u){if(t[u])return t[u].exports;var v=t[u]={i:u,l:!1,exports:{}};return r[u].call(v.exports,v,v.exports,s),v.l=!0,v.exports}var t={};return s.m=r,s.c=t,s.i=function(u){return u},s.d=function(u,v,w){s.o(u,v)||Object.defineProperty(u,v,{configurable:!1,enumerable:!0,get:w})},s.n=function(u){var v=u&&u.__esModule?function(){return u['default']}:function(){return u};return s.d(v,'a',v),v},s.o=function(u,v){return Object.prototype.hasOwnProperty.call(u,v)},s.p='',s(s.s=3)}([function(r,s){'use strict';Object.defineProperty(s,'__esModule',{value:!0}),s.default={auth0IdTokenKeyName:'auth0Token',gqlServerTokenStorageKey:'graphCoolToken'}},function(r,s,t){'use strict';function v(B,C){if(!(B instanceof C))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(s,'__esModule',{value:!0}),s.Configurable=void 0;var w='function'==typeof Symbol&&'symbol'===q(Symbol.iterator)?function(B){return'undefined'==typeof B?'undefined':q(B)}:function(B){return B&&'function'==typeof Symbol&&B.constructor===Symbol&&B!==Symbol.prototype?'symbol':'undefined'==typeof B?'undefined':q(B)},x=function(){function B(C,D){for(var F,E=0;E<D.length;E++)F=D[E],F.enumerable=F.enumerable||!1,F.configurable=!0,'value'in F&&(F.writable=!0),Object.defineProperty(C,F.key,F)}return function(C,D,E){return D&&B(C.prototype,D),E&&B(C,E),C}}(),y=t(0),z=function(B){return B&&B.__esModule?B:{default:B}}(y),A=s.Configurable=function(){function B(){var C=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},D=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};v(this,B),this.validate(C);var E=C.keyNames,F=C.store,G=C.storage;this.config=C,this.io=D.io||console,this.logging=D.logging,this.observers={},this.config=C,this.storage=G,this.keyNames=E||G||z.default,this.store=F||this.defaultCreateStore(this.keyNames,D),this.tokens=this.store.getAll(),this.tokens=this.store?this.store.getAll():C.tokens}return x(B,[{key:'on',value:function(D,E){this.log('on',D,E);var F=this.observers[D]||[];return this.observers[D]=F.concat(E),this}},{key:'publish',value:function(D,E){this.log('publish',D,E);var F=this.observers[D]||[];return F?F.map(function(G){return G(E)}):this.log('no observers registered for',D),this}},{key:'handleError',value:function(D){throw this.error(D),D}},{key:'enableLog',value:function(){return this.logging=!0,this}},{key:'disableLog',value:function(){return this.logging=!1,this}},{key:'log',value:function(){if(this.logging){for(var D,E=arguments.length,F=Array(E),G=0;G<E;G++)F[G]=arguments[G];(D=this.io).log.apply(D,['Lock'].concat(F))}}},{key:'error',value:function(){if(this.logging){for(var D,E=arguments.length,F=Array(E),G=0;G<E;G++)F[G]=arguments[G];(D=this.io).error.apply(D,['Lock'].concat(F))}}},{key:'defaultCreateStore',value:function(D,E){return new Store(D,E)}},{key:'validate',value:function(D){if('object'!==('undefined'==typeof D?'undefined':w(D)))throw Error('config must be an object')}}]),B}()},function(r,s){'use strict';function u(y,z){if(!(y instanceof z))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(s,'__esModule',{value:!0});var w=function(){function y(z,A){for(var C,B=0;B<A.length;B++)C=A[B],C.enumerable=C.enumerable||!1,C.configurable=!0,'value'in C&&(C.writable=!0),Object.defineProperty(z,C.key,C)}return function(z,A,B){return A&&y(z.prototype,A),B&&y(z,B),z}}();s.createStore=function(y){var z=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return new x(y,z)};var x=s.Store=function(){function y(z){1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};u(this,y),this.keyNames=z,this.validateKeyName('auth0IdTokenKeyName').validateKeyName('gqlServerTokenKeyName'),this.auth0IdTokenKeyName=this.keyNames.auth0IdTokenKeyName,this.gqlServerTokenKeyName=this.keyNames.gqlServerTokenKeyName}return w(y,[{key:'removeItem',value:function(A){localStorage.removeItem(A)}},{key:'getItem',value:function(A){return localStorage.getItem(A)}},{key:'setItem',value:function(A,B){localStorage.setItem(A,B)}},{key:'validateKeyName',value:function(A){return'string'!=typeof this.keyNames[A]&&this.error('keyNames missing '+A),this}},{key:'error',value:function(A){console.error(A)}},{key:'resetAll',value:function(){this.removeItem(this.auth0TokenKeyName),this.removeItem(this.gqlServerTokenKeyName)}},{key:'getAll',value:function(){0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return{auth0Token:this.getItem(this.auth0IdTokenKeyName),gqlServerToken:this.getItem(this.gqlServerTokenKeyName)}}},{key:'store',value:function(A,B){2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(0>this.keyNames.indexOf(A))throw Error('keyname mismatch for store: '+A);this.setItem(A,B)}}]),y}()},function(r,s,t){'use strict';Object.defineProperty(s,'__esModule',{value:!0});var u=t(1);Object.defineProperty(s,'Configurable',{enumerable:!0,get:function(){return u.Configurable}});var v=t(0);Object.defineProperty(s,'keyNames',{enumerable:!0,get:function(){return v.keyNames}});var w=t(2);Object.defineProperty(s,'Store',{enumerable:!0,get:function(){return w.Store}}),Object.defineProperty(s,'createStore',{enumerable:!0,get:function(){return w.createStore}})}])})}).call(k,l(4)(j))},function(j,k,l){'use strict';function m(u){return function(){var v=u.apply(this,arguments);return new Promise(function(w,x){function y(z,A){try{var B=v[z](A),C=B.value}catch(D){return void x(D)}return B.done?void w(C):Promise.resolve(C).then(function(D){y('next',D)},function(D){y('throw',D)})}return y('next')})}}function n(u,v){if(!(u instanceof v))throw new TypeError('Cannot call a class as a function')}function o(u,v){if(!u)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return v&&('object'===('undefined'==typeof v?'undefined':h(v))||'function'==typeof v)?v:u}function p(u,v){if('function'!=typeof v&&null!==v)throw new TypeError('Super expression must either be null or a function, not '+('undefined'==typeof v?'undefined':h(v)));u.prototype=Object.create(v&&v.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(u,v):u.__proto__=v)}Object.defineProperty(k,'__esModule',{value:!0}),k.GraphQLAuth=void 0;var r=function(){function u(v,w){for(var y,x=0;x<w.length;x++)y=w[x],y.enumerable=y.enumerable||!1,y.configurable=!0,'value'in y&&(y.writable=!0),Object.defineProperty(v,y.key,y)}return function(v,w,x){return w&&u(v.prototype,w),x&&u(v,x),v}}();k.createGraphQLServerAuth=function(u){new GraphQLServerAuth(u)};var s=l(0),t=k.GraphQLAuth=function(u){function v(w){return n(this,v),o(this,(v.__proto__||Object.getPrototypeOf(v)).call(this,w))}return p(v,u),r(v,[{key:'extractSignedInUserToken',value:function(x){return x.data.signinUser.token}},{key:'setGraphQLServerToken',value:function(x){return this.store.setItem(this.gqlServerTokenKeyName,x),this}},{key:'signin',value:function(){var x=m(regeneratorRuntime.mark(function y(z){var A,B,C,D,E;return regeneratorRuntime.wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return A=z.auth0Token,B=z.profile,this.log('Signing into GraphQL server'),G.next=4,this.doCreateUser(z);case 4:return C=G.sent,G.next=7,this.doSigninUser(z);case 7:D=G.sent,E=this.extractSignedInUserToken(D),this.setGraphQLServerToken(E);case 10:case'end':return G.stop();}},y,this)}));return function(){return x.apply(this,arguments)}}()},{key:'handleQueryError',value:function(x){x.graphQLErrors&&x.graphQLErrors[0].code===errorCode.USER_ALREADY_EXISTS||this.handleError(x)}},{key:'buildUserData',value:function(x){var y=x.auth0Token,z=x.profile;return{variables:{authToken:y,name:z.name}}}},{key:'doCreateUser',value:function(){var x=m(regeneratorRuntime.mark(function y(z){var A,B,C;return regeneratorRuntime.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(A=z.auth0Token,B=z.profile,E.prev=1,this.log('Create user',name),C=this.buildUserData(z),!this.queries.createUser){E.next=9;break}return E.next=7,this.queries.createUser(C);case 7:E.next=12;break;case 9:return this.log('missing createUser query, faking it'),E.next=12,this.fakeCreateUser(C);case 12:E.next=17;break;case 14:E.prev=14,E.t0=E['catch'](1),this.handleQueryError(E.t0);case 17:case'end':return E.stop();}},y,this,[[1,14]])}));return function(){return x.apply(this,arguments)}}()},{key:'fakeCreateUser',value:function(x){return x}},{key:'buildSigninUserData',value:function(x){var y=x.auth0Token,z=x.profile;return{variables:{authToken:y}}}},{key:'doSigninUser',value:function(){var x=m(regeneratorRuntime.mark(function y(z){var A,B,C;return regeneratorRuntime.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(A=z.auth0Token,B=z.profile,this.log('signin user',z),this.queries.signinUser){E.next=4;break}return E.abrupt('return',this.fakeSigninUser(B));case 4:return C=this.buildSigninUserData(z),E.next=7,this.queries.signinUser(C);case 7:return E.abrupt('return',E.sent);case 8:case'end':return E.stop();}},y,this)}));return function(){return x.apply(this,arguments)}}()},{key:'fakeSigninUser',value:function(){return this.log('returning fake signedinUser'),{data:{signinUser:{token:'1234'}}}}},{key:'gqlServerTokenKeyName',get:function(){return this.store.gqlServerTokenKeyName}}]),v}(s.Configurable)},function(j,k,l){'use strict';function m(r,s){if(!(r instanceof s))throw new TypeError('Cannot call a class as a function')}function n(r,s){if(!r)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return s&&('object'===('undefined'==typeof s?'undefined':h(s))||'function'==typeof s)?s:r}function o(r,s){if('function'!=typeof s&&null!==s)throw new TypeError('Super expression must either be null or a function, not '+('undefined'==typeof s?'undefined':h(s)));r.prototype=Object.create(s&&s.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),s&&(Object.setPrototypeOf?Object.setPrototypeOf(r,s):r.__proto__=s)}Object.defineProperty(k,'__esModule',{value:!0}),k.GraphQLConnection=void 0;var p=l(0),q=k.GraphQLConnection=function(r){function s(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};m(this,s);var u=n(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,t));return u.connection=t.gqlServer.connection,u}return o(s,r),s}(p.Configurable)},function(j,k,l){'use strict';Object.defineProperty(k,'__esModule',{value:!0});var m=l(1);Object.defineProperty(k,'GraphQLAuth',{enumerable:!0,get:function(){return m.GraphQLAuth}});var n=l(2);Object.defineProperty(k,'GraphQLConnection',{enumerable:!0,get:function(){return n.GraphQLConnection}})},function(j){j.exports=function(l){return l.webpackPolyfill||(l.deprecate=function(){},l.paths=[],!l.children&&(l.children=[]),Object.defineProperty(l,'loaded',{enumerable:!0,get:function(){return l.l}}),Object.defineProperty(l,'id',{enumerable:!0,get:function(){return l.i}}),l.webpackPolyfill=1),l}}])})}).call(b,c(3)(a))},function(a,b,c){'use strict';Object.defineProperty(b,'__esModule',{value:!0});var d=c(0);Object.defineProperty(b,'Connection',{enumerable:!0,get:function(){return d.LokkaConnection}}),Object.defineProperty(b,'createConnection',{enumerable:!0,get:function(){return d.createConnection}})},function(a){a.exports=function(c){return c.webpackPolyfill||(c.deprecate=function(){},c.paths=[],!c.children&&(c.children=[]),Object.defineProperty(c,'loaded',{enumerable:!0,get:function(){return c.l}}),Object.defineProperty(c,'id',{enumerable:!0,get:function(){return c.i}}),c.webpackPolyfill=1),c}}])});
//# sourceMappingURL=bundle.prod.js.map